#!perl

use Cwd;
use HTML::Entities;
use RTF::Writer;

print "\n\n\n\nCe script a pour but de transformer les fichier .xml de l'application Apafis en fichiers lisibles dans un traitement de texte.\n Chaque fichier .xml sera converti en .doc \n
ATTENTION, si un fichier du nom de la saisine (.doc) existe, il sera repris par le script.\n-
Aucune garantie n'est fournie sur l'exactitude de la retranscription par le script, si vous constatez un souci, merci de m'en faire part.\n-
Benoit Petit-Demouliere : petitd\@igbmc.fr\n

Script Version 1.02 - 07/03/2019.

Continuez en tapant 1 puis Valider, ou quittez en tapant une autre touche.\n";
chomp (my $result = <STDIN>);
if ($result == 1){
my $dir = cwd();

opendir DIR, $dir or die "cannot open dir $dir: $!";
my @files = glob "$dir/*.xml";
closedir(DIR);

foreach(@files){
  my $qfn = $_;

open IN,$qfn or die $!;
open OUT,">",$qfn."\.doc" or die $!;

while (<IN>) {
my $line = $_;
chomp $line;


my %balises = ("InformationsGenerales"=>"1. INFORMATIONS GÉNÉRALES\n","TitreProjet"=>"1.1. TITRE DU PROJET :\n","DureeProjet"=>"\n1.2. Durée du projet : ","DureeAnnees"=>"Années :","DureeMois"=>"Mois :","DureeJours"=>"Jours :","DatePrevueDebutProjet"=>"\n1.3. Date prévue de début du projet (Année-Mois-Jour): ","Date"=>"Date :","RNT"=>"\n2. RÉSUMÉ NON TECHNIQUE \n","InformationsAdministrativesEtReglementaires"=>"\n\n3. INFORMATIONS ADMINISTRATIVES ET RÉGLEMENTAIRES","EtablissementUtilisateur"=>"\n3.1. L établissement utilisateur (EU)","AgrementUE"=>"\n3.1.1. Agrement de l EU où seront utilisés les animaux :","NomUE"=>"Nom :","NumeroAgrement"=>"Numéro d'agrément :","DateDelivrance"=>"Date de délivrance de l'agrément :","CiviliteResponsable"=>"Civilité :","NomResponsable"=>"Nom du responsable :","PrenomResponsable"=>"Prénom du responsable :","EMailResponsable"=>"Adresse électronique du responsable :","CiviliteDelegataire"=>"Civilité du délégataire :","NomDelegataire"=>"Nom de la personne délégataire du responsable présente dans l'EU :","PrenomDelegataire"=>"Prénom de la personne délégataire du responsable présente dans l'EU :","EMailDelegataire"=>"Adresse électronique de ce délégataire :","ComiteEthiqueAgree"=>"\n3.1.2. Comité d'éthique agréé par le MESR dont relève l'EU :\n","ResponsablesMiseEnOeuvre NombreResponsablesMiseEnOeuvre=\"1\""=>"\n3.1.3. Responsable(s) de la mise en oeuvre générale du projet dans l'EU et de sa conformité à l'autorisation de projet :","ResponsablesMiseEnOeuvre NombreResponsablesMiseEnOeuvre=\"2\""=>"\n3.1.3. Responsable(s) de la mise en œuvre générale du projet dans l'EU et de sa conformité à l'autorisation de projet :","ResponsablesMiseEnOeuvre NombreResponsablesMiseEnOeuvre=\"3\""=>"\n3.1.3. Responsable(s) de la mise en œuvre générale du projet dans l'EU et de sa conformité à l'autorisation de projet :","ResponsablesMiseEnOeuvre NombreResponsablesMiseEnOeuvre=\"4\""=>"\n3.1.3. Responsable(s) de la mise en œuvre générale du projet dans l'EU et de sa conformité à l'autorisation de projet :","CoordonneesResponsablesMiseEnOeuvre"=>"\nResponsable(s) :","Civilite"=>"Civilité :","Nom"=>"Nom :","Prenom"=>"Prenom :","AdressePostale"=>"Adresse postale :","NomLaboratoire"=>"Nom du Laboratoire :","ComplementAdresse"=>"Complément :","NumeroRue"=>"Numéro de rue :","Voie"=>"Voie :","CodePostal"=>"Code Postal :","Ville"=>"Ville :","Pays"=>"Pays :","Email"=>"Email :","NumTelephone"=>"Téléphone :","ResponsablesBienEtre NombreResponsablesBienEtre=\"1\""=>"\n3.1.4. Responsable(s) du bien-être des animaux :","ResponsablesBienEtre NombreResponsablesBienEtre=\"2\""=>"\n3.1.4. Responsable(s) du bien-être des animaux :","ResponsablesBienEtre NombreResponsablesBienEtre=\"3\""=>"\n3.1.4. Responsable(s) du bien-être des animaux :","ResponsablesBienEtre NombreResponsablesBienEtre=\"4\""=>"\n3.1.4. Responsable(s) du bien-être des animaux :","CoordonneesResponsablesBienEtre"=>"\nResponsable(s) :","Personnel"=>"\n3.2. Le personnel ","ConceptionProceduresExp"=>"Compétences des personnes participant au projet :\nla conception des procédures expérimentales et des projets\t","ApplicationProceduresExp"=>"l'application de procédures expérimentales aux animaux\t","SoinAuxAnimaux"=>"les soins aux animaux\t","MiseAMort"=>"la mise à mort des animaux\t","Projet"=>"\n3.3. Le projet","ObjectifDuProjet"=>"\n3.3.1. L'objectif du projet :","JustificationProjet"=>"Est-il :","JustifieEducativement"=>"justifié du point de vue éducatif ?","RequisLoi"=>"requis par la loi ?","JustifieScientifiquement"=>"justifié du point de vue scientifique ?","InformationsJustification"=>"Informations sur cette justification :","DescriptionProjet"=>"\n3.3.2. Description du projet :\n","MethodeMiseAMort"=>"\n3.3.3. Précisez, le cas échéant, la ou les méthodes de mise à mort prévue(s) :\n","ElementsScientifiquesJustifiantDemandeMiseAMort"=>"\n3.3.4. Précisez, le cas échéant, les éléments scientifiques justifiant la demande de dérogation concernant la méthode de mise à mort envisagée :\n","StrategieExperimentations"=>"\n3.3.5. Stratégie d'expérimentation ou d'observation et approche statistique utilisée afin de réduire au minimum le nombre d'animaux, la douleur, la souffrance et l'angoisse, infligées et l'impact environnemental, le cas échéant . si une étude statistique est prévue, indiquez et justifiez les tests choisis :\n","Animaux"=>"\n3.4. Les animaux","JustificationRecoursAuxAnimaux"=>"\n3.4. Les animaux\n3.4.1. Justifiez la nécessité d'avoir recours à des animaux pour atteindre les objectifs du projet :\n","ListeAnimaux"=>"\n3.4.2. Espèces animales ou types d'animaux utilisés :","Souris"=>"Souris\t\t\t","Rats"=>"Rats\t\t\t\t","Cobayes"=>"Cobayes\t\t\t","HamstersSyriens"=>"HamstersSyriens\t\t","HamstersChinois"=>"HamstersChinois\t\t","Gerbille"=>"Gerbille\t\t\t","AutresRongeurs"=>"AutresRongeurs\t\t","Lapins"=>"Lapins\t\t\t","Chats"=>"Chats\t\t\t\t","Chiens"=>"Chiens\t\t\t","Furets"=>"Furets\t\t\t","AutresCarnivores"=>"AutresCarnivores\t\t","Chevaux"=>"Chevaux\t\t\t","Porcs"=>"Porcs\t\t\t\t","Caprins"=>"Caprins\t\t\t","Ovins"=>"Ovins\t\t\t\t","Bovins"=>"Bovins\t\t\t","Prosimien"=>"Prosimien\t\t\t","Ouistitis"=>"Ouistitis\t\t\t","SingeCynomologue"=>"SingeCynomologue\t\t","SingeRhesus"=>"SingeRhesus\t\t\t","Vervets"=>"Vervets\t\t\t","Babouins"=>"Babouins\t\t\t","Sairimis"=>"Sairimis\t\t\t","AutresPrimateNonHumain"=>"AutresPrimateNonHumain\t","SingesAntropoides"=>"SingesAntropoides\t","AutresMammiferes"=>"AutresMammiferes\t\t","PoulesDomestiques"=>"PoulesDomestiques\t","AutresOiseaux"=>"AutresOiseaux\t\t","Reptiles"=>"Reptiles\t\t\t","GrenouillesRana"=>"GrenouillesRana\t\t","GrenouillesXenopus"=>"GrenouillesXenopus\t","AutresAmphibiens"=>"AutresAmphibiens\t\t","PoissonsZebres"=>"PoissonsZebres\t\t","AutresPoissons"=>"AutresPoissons\t\t","Cephalopodes"=>"Cephalopodes\t\t","PertinenceAnimauxChoisis"=>"\n3.4.3. Justifiez la pertinence de l'(des) espèce(s) animale(s) choisie(s) :\n","EspecesMenacees"=>"\n3.4.4. S'agit-il de spécimens d'espèces menacées énumérées à l'annexe A du règlement (CE) n° 338/97 du Conseil du 9 décembre 1996 relatif à la protection des espèces de faune et de flore sauvages par le contrôle et leur commerce ?\n","OuiEspecesMenacees"=>"\tSi oui, éléments scientifiques démontrant que la finalité de la procédure expérimentale ne peut être atteinte en utilisant d'autres espèces que celles énumérées dans cette annexe :\n","Primate"=>"\n3.4.5. S'agit-il de spécimens de primates non humains ?","OuiPrimate"=>"\tSi oui, éléments scientifiques démontrant que la finalité de la procédure expérimentale ne peut être atteinte en utilisant d'autres espèces de primates non humains:\n","CaptureNature"=>"\n3.4.6. S'agit-il d'animaux capturés dans la nature ? ","OuiCaptureNature"=>"\tSi oui, éléments scientifiques démontrant que la finalité de la procédure expérimentale ne peut être atteinte en utilisant d'autres animaux que ceux  capturés dans la nature :\n","EspeceDomestique"=>"\n3.4.7. S'agit-il d'animaux d'espèces domestiques, errants ou vivant à l'état sauvage ?","OuiEspeceDomestique"=>"\tSi oui, éléments scientifiques démontrant que la finalité de la procédure expérimentale ne peut être atteinte qu'en utilisant ces animaux.\n","CategorieAnimauxUtilises"=>"\n3.4.8. Catégorie des animaux utilisés dans le projet :","AnimauxEnCaptivite"=>"Animaux tenus en captivité (domestiques ou non domestiques) ","AnimauxNonDomNonCaptifs"=>"Animaux non domestiques non tenus en captivité","ReferencesDerogationsEspProtegee"=>"\tSi les animaux utilisés sont des spécimens d'espèces protégées en application de l'article L. 411-1 du Code de l'environnement, indiquez les références de la dérogation accordée pour effectuer la capture des animaux dans le milieu naturel (4° de l'article L. 411-2 du Code de l'environnement) :\n","ReferencesDerogationsChasseAutorisee"=>"\tSi les animaux utilisés sont des spécimens d'espèces dont la chasse est autorisée, indiquez ici les références de l'autorisation de prélèvement accordée pour effectuer la capture des animaux dans le milieu naturel (article L. 424-11 du Code de l'environnement) :\n","Justification"=>"\nJustification scientifique montrant que l'objectif de la procédure expérimentale ne peut être atteint en utilisant un animal élevé en vue d'une utilisation dans des procédures expérimentales :\n","OuiAnimauxGenetiquementAlteres"=>"Animaux génétiquement altérés","AnimauxGenetiquementModifies"=>"Animaux génétiquement modifiés","CreationLignee"=>"Création d'une lignée","MaintienLigneeEtablie"=>"Maintien d'une lignée établie et/ou utilisation","PhenotypeDommageable"=>"Phénotype dommageable","CategorieAnimauxUtilises"=>"\n3.4.8. Catégorie des animaux utilisés dans le projet :","OrigineAnimaux"=>"\n3.4.9. Origine des animaux tenus en captivité :","ElevesAFinExperimentale"=>"Les animaux destinés à être utilisés dans les procédures expérimentales appartenant aux espèces dont la liste est fixée réglementairement sont-ils élevés à cette fin et proviennent-ils d'éleveurs ou de fournisseurs agréés ?","OuiEleves NombreEtablissementEleveur=\"1\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 1","OuiEleves NombreEtablissementEleveur=\"2\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 2","OuiEleves NombreEtablissementEleveur=\"3\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 3","OuiEleves NombreEtablissementEleveur=\"4\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 4","OuiEleves NombreEtablissementEleveur=\"5\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 5","OuiEleves NombreEtablissementEleveur=\"6\""=>"Si oui, nombre d'établissements éleveur ou fournisseur agréés fournissant tout ou partie des animaux du projet : 6","OuiElevesAFinExperimentale"=>"Etablissement :","NomEtablissement"=>"Nom :","AdressePostaleEtablissement"=>"Adresse postale :","NomLaboratoire"=>"Nom du Laboratoire :","AdressePostaleEtablissement"=>"Adresse postale :","AnimauxFournis"=>"Animaux Fournis","OuiEleves"=>"","NonEleves"=>"Si non, justifier scientifiquement l'utilisation d'animaux qui ne proviennent pas d'éleveurs ou de fournisseurs agréés :","NonEleves"=>"Si non, justifier scientifiquement l'utilisation d'animaux qui ne proviennent pas d'éleveurs ou de fournisseurs agréés :","VotreEUFournitToutOuPartieAnimaux"=>"\nVotre propre établissement utilisateur fournit-il tout ou partie des animaux du projet ?","AutreEUFournitToutOuPartieAnimaux"=>"Un autre établissement utilisateur fournit-il tout ou partie des animaux du projet ?","EtablissementsNonAgreesFournissantAnimaux NombreEtablissementsNonAgreesFournissantAnimaux=\"1\""=>"Nombre d'établissements éleveur occasionnel non agréés fournissant tout ou partie des animaux du projet ? 1","EtablissementsNonAgreesFournissantAnimaux NombreEtablissementsNonAgreesFournissantAnimaux=\"2\""=>"Nombre d'établissements éleveur occasionnel non agréés fournissant tout ou partie des animaux du projet ? 2","EtablissementsNonAgreesFournissantAnimaux NombreEtablissementsNonAgreesFournissantAnimaux=\"3\""=>"Nombre d'établissements éleveur occasionnel non agréés fournissant tout ou partie des animaux du projet ? 3","EtablissementsNonAgreesFournissantAnimaux NombreEtablissementsNonAgreesFournissantAnimaux=\"4\""=>"Nombre d'établissements éleveur occasionnel non agréés fournissant tout ou partie des animaux du projet ? 4","NomEtablissementsNonAgreesFournissantAnimaux"=>"Nom :","EtablissementsNonAgreesFournissantAnimaux"=>"Nom :","EtablissementsEtatsMembresFournissantAnimaux NombreEtablissementsEtatsMembresFournissantAnimaux=\"1\""=>"\nNombre d'établissements éleveur ou fournisseur localisés dans des Etats membres autres que la France fournissant tout ou partie des animaux du projet ? 1","EtablissementsEtatsMembresFournissantAnimaux NombreEtablissementsEtatsMembresFournissantAnimaux=\"2\""=>"\nNombre d'établissements éleveur ou fournisseur localisés dans des Etats membres autres que la France fournissant tout ou partie des animaux du projet ? 2","EtablissementEtatMembre"=>"Etablissement :","NomEtablissementsEtatsMembresFournissantAnimaux"=>"Nom de cet éleveur ou fournisseur  :","PaysEtablissementsEtatsMembresFournissantAnimaux"=>"Pays :","EtablissementsEtatsTiersFournissantAnimaux NombreEtablissementsEtatsTiersFournissantAnimaux=\"1\""=>"\nNombre d'établissements éleveur ou fournisseur localisés dans des pays tiers fournissant tout ou partie des animaux du projet ? 1","EtablissementsEtatsTiersFournissantAnimaux NombreEtablissementsEtatsTiersFournissantAnimaux=\"2\""=>"\nNombre d'établissements éleveur ou fournisseur localisés dans des pays tiers fournissant tout ou partie des animaux du projet ? 2","EtablissementsEtatsTiersFournissantAnimaux NombreEtablissementsEtatsTiersFournissantAnimaux=\"3\""=>"Nombre d'établissements éleveur ou fournisseur localisés dans des pays tiers fournissant tout ou partie des animaux du projet ? 3","EtablissementEtatTiers"=>"Etablissement :","NomEtablissementsEtatsTiersFournissantAnimaux"=>"Nom de cet éleveur ou fournisseur  :","PaysEtablissementsEtatsTiersFournissantAnimaux"=>"Pays :","AnimauxReutilisesProjetPrecedent"=>"Les animaux sont-ils des animaux réutilisés d'un projet précédent ?","OrigineAnimaux"=>"\n3.4.9. Origine des animaux\n","AnimauxUtilises"=>"","NombreAnimauxUtilises"=>"\n3.4.10. Nombre estimé d'animaux utilisés dans le projet :\n","JustificationUtilisationEspeces"=>"Justification de ce nombre pour chacune des espèces animales utilisées :\n","UtilisationQuelStade"=>"\n3.4.11. Indiquez à quel(s) stade(s) de développement les animaux seront utilisés et le justifier :\n","SexeAnimauxUtilisesJustification"=>"\n3.4.12. Indiquez le sexe des animaux utilisés et le justifier :\n","PointsLimitesAdaptes"=>"\nIndiquez pour chaque espèce les points limites adaptés, suffisamment prédictifs et précoces pour permettre de limiter la douleur à son minimum, sans remettre en cause les résultats du projet :\n","Animaux"=>"","InformationsAdministrativesEtReglementaires"=>"\n3. INFORMATIONS ADMINISTRATIVES ET RÉGLEMENTAIRES","ProceduresExperimentales"=>"\n4. LES PROCÉDURES EXPÉRIMENTALES","ObjetsVises"=>"\n4.1 Objet(s) visés par les procédures expérimentales","PointA"=>"A - La recherche fondamentale.\t\t\t","PointB"=>"B - Les recherches transactionnelles ou appliquées menées pour :\n- la prévention, la prophylaxie, le diagnostic ou le traitement de maladies, de mauvais états de santé ou d'autres anomalies ou de leurs effets chez l'homme, les animaux ou les plantes ;\n- l'évaluation, la détection, le contrôle ou les modifications des conditions physiologiques chez l'homme, les animaux ou les plantes ;\n- le bien-être des animaux et l'amélioration des conditions de production des animaux élevés à des fins agronomiques.","PointC"=>"C - L'une des finalités visées au point précédent (B) lors de la mise au point, de la production ou des essais de qualité, d'efficacité et d'innocuité de médicaments à usage humain ou vétérinaire, de denrées alimentaires, d'aliments pour animaux et d'autres substances ou produits.","PointD"=>"D - La protection de l'environnement naturel dans l'intérêt de la santé ou du bien-être de l'homme ou de l'animal.","PointE"=>"E- La recherche en vue de la conservation des espèces.","PointF"=>"F- L'enseignement supérieur, ou la formation professionnelle ou technique conduisant à des métiers qui comportent la réalisation de procédures expérimentales sur des animaux ou les soins et l'entretien de ces animaux, ainsi que la formation professionnelle continue dans ce domaine.","PointG"=>"G - Les enquêtes médico-légales.","ExplicationsProcedures NombreProcedures=\"1\""=>"\n4.2 Nombre de procédures expérimentales :  1","ExplicationsProcedures NombreProcedures=\"2\""=>"\n4.2 Nombre de procédures expérimentales :  2","ExplicationsProcedures NombreProcedures=\"3\""=>"\n4.2 Nombre de procédures expérimentales :  3","ExplicationsProcedures NombreProcedures=\"4\""=>"\n4.2 Nombre de procédures expérimentales :  4","ExplicationsProcedures NombreProcedures=\"5\""=>"\n4.2 Nombre de procédures expérimentales :  5","ExplicationsProcedures NombreProcedures=\"6\""=>"\n4.2 Nombre de procédures expérimentales :  6","ExplicationsProcedures NombreProcedures=\"7\""=>"\n4.2 Nombre de procédures expérimentales :  7","ExplicationsProcedures NombreProcedures=\"8\""=>"\n4.2 Nombre de procédures expérimentales :  8","ExplicationsProcedures NombreProcedures=\"9\""=>"\n4.2 Nombre de procédures expérimentales :  9","ExplicationsProcedures NombreProcedures=\"10\""=>"\n4.2 Nombre de procédures expérimentales :  10","ExplicationsProcedures NombreProcedures=\"11\""=>"\n4.2 Nombre de procédures expérimentales :  11","ExplicationsProcedures NombreProcedures=\"12\""=>"\n4.2 Nombre de procédures expérimentales :  12","ExplicationsProcedures NombreProcedures=\"13\""=>"\n4.2 Nombre de procédures expérimentales :  13","ExplicationsProcedures NombreProcedures=\"14\""=>"\n4.2 Nombre de procédures expérimentales :  14","ExplicationsProcedures NombreProcedures=\"15\""=>"\n4.2 Nombre de procédures expérimentales :  15","ExplicationsProcedures NombreProcedures=\"16\""=>"\n4.2 Nombre de procédures expérimentales :  16","ExplicationsProcedures NombreProcedures=\"17\""=>"\n4.2 Nombre de procédures expérimentales :  17","ExplicationsProcedures NombreProcedures=\"18\""=>"\n4.2 Nombre de procédures expérimentales :  18","ExplicationsProcedures NombreProcedures=\"19\""=>"\n4.2 Nombre de procédures expérimentales :  19","ExplicationsProcedures NombreProcedures=\"20\""=>"\n4.2 Nombre de procédures expérimentales :  20","ExplicationsProcedures NombreProcedures=\"21\""=>"\n4.2 Nombre de procédures expérimentales :  21","ExplicationsProcedures NombreProcedures=\"22\""=>"\n4.2 Nombre de procédures expérimentales :  22","ExplicationsProcedures NombreProcedures=\"23\""=>"\n4.2 Nombre de procédures expérimentales :  23","ExplicationsProcedures NombreProcedures=\"24\""=>"\n4.2 Nombre de procédures expérimentales :  24","ExplicationsProcedures NombreProcedures=\"25\""=>"\n4.2 Nombre de procédures expérimentales :  25","ExplicationsProcedures NombreProcedures=\"26\""=>"\n4.2 Nombre de procédures expérimentales :  26","ExplicationsProcedures NombreProcedures=\"27\""=>"\n4.2 Nombre de procédures expérimentales :  27","ExplicationsProcedures NombreProcedures=\"28\""=>"\n4.2 Nombre de procédures expérimentales :  28","ExplicationsProcedures NombreProcedures=\"29\""=>"\n4.2 Nombre de procédures expérimentales :  29","ExplicationsProcedures NombreProcedures=\"30\""=>"\n4.2 Nombre de procédures expérimentales :  30","ExplicationsProcedures NombreProcedures=\"31\""=>"\n4.2 Nombre de procédures expérimentales :  31","ExplicationsProcedures NombreProcedures=\"32\""=>"\n4.2 Nombre de procédures expérimentales :  32","ExplicationsProcedures NombreProcedures=\"33\""=>"\n4.2 Nombre de procédures expérimentales :  33","ExplicationsProcedures NombreProcedures=\"34\""=>"\n4.2 Nombre de procédures expérimentales :  34","ExplicationsProcedures NombreProcedures=\"35\""=>"\n4.2 Nombre de procédures expérimentales :  35","ExplicationsProcedures NombreProcedures=\"36\""=>"\n4.2 Nombre de procédures expérimentales :  36","ExplicationsProcedures NombreProcedures=\"37\""=>"\n4.2 Nombre de procédures expérimentales :  37","ExplicationsProcedures NombreProcedures=\"38\""=>"\n4.2 Nombre de procédures expérimentales :  38","ExplicationsProcedures NombreProcedures=\"39\""=>"\n4.2 Nombre de procédures expérimentales :  39","ExplicationsProcedures NombreProcedures=\"40\""=>"\n4.2 Nombre de procédures expérimentales :  40","ExplicationsProcedures NombreProcedures=\"41\""=>"\n4.2 Nombre de procédures expérimentales :  41","ExplicationsProcedures NombreProcedures=\"42\""=>"\n4.2 Nombre de procédures expérimentales :  42","ExplicationsProcedures NombreProcedures=\"43\""=>"\n4.2 Nombre de procédures expérimentales :  43","ExplicationsProcedures NombreProcedures=\"44\""=>"\n4.2 Nombre de procédures expérimentales :  44","ExplicationsProcedures NombreProcedures=\"45\""=>"\n4.2 Nombre de procédures expérimentales :  45","ExplicationsProcedures NombreProcedures=\"46\""=>"\n4.2 Nombre de procédures expérimentales :  46","ExplicationsProcedures NombreProcedures=\"47\""=>"\n4.2 Nombre de procédures expérimentales :  47","ExplicationsProcedures NombreProcedures=\"48\""=>"\n4.2 Nombre de procédures expérimentales :  48","ExplicationsProcedures NombreProcedures=\"49\""=>"\n4.2 Nombre de procédures expérimentales :  49","ExplicationsProcedures NombreProcedures=\"50\""=>"\n4.2 Nombre de procédures expérimentales :  50","ExplicationsProcedures NombreProcedures=\"51\""=>"\n4.2 Nombre de procédures expérimentales :  51","ExplicationsProcedures NombreProcedures=\"52\""=>"\n4.2 Nombre de procédures expérimentales :  52","ExplicationsProcedures NombreProcedures=\"53\""=>"\n4.2 Nombre de procédures expérimentales :  53","ExplicationsProcedures NombreProcedures=\"54\""=>"\n4.2 Nombre de procédures expérimentales :  54","ExplicationsProcedures NombreProcedures=\"55\""=>"\n4.2 Nombre de procédures expérimentales :  55","ExplicationsProcedures NombreProcedures=\"56\""=>"\n4.2 Nombre de procédures expérimentales :  56","ExplicationsProcedures NombreProcedures=\"57\""=>"\n4.2 Nombre de procédures expérimentales :  57","ExplicationsProcedures NombreProcedures=\"58\""=>"\n4.2 Nombre de procédures expérimentales :  58","ExplicationsProcedures NombreProcedures=\"59\""=>"\n4.2 Nombre de procédures expérimentales :  59","ExplicationsProcedures NombreProcedures=\"60\""=>"\n4.2 Nombre de procédures expérimentales :  60","ExplicationsProcedures NombreProcedures=\"61\""=>"\n4.2 Nombre de procédures expérimentales :  61","ExplicationsProcedures NombreProcedures=\"62\""=>"\n4.2 Nombre de procédures expérimentales :  62","ExplicationsProcedures NombreProcedures=\"63\""=>"\n4.2 Nombre de procédures expérimentales :  63","ExplicationsProcedures NombreProcedures=\"64\""=>"\n4.2 Nombre de procédures expérimentales :  64","Procedure"=>"\nPROCEDURE","NomProcedure"=>"NOM DE LA PROCÉDURE EXPÉRIMENTALE N° x :\n","ClassificationProcedure"=>"\nPROPOSITION DE CLASSIFICATION DE LA PROCÉDURE SELON LE DEGRÉ DE SÉVÉRITE (conformément à l'annexe de l'arrêté relatif à l'autorisation de projet) :","DescriptionDetaillee"=>"\nDescription détaillée de la procédure expérimentale :","PertinenceJustification"=>"Pertinence et justification de la procédure expérimentale :\n","NombreLots"=>"\nIndiquez le nombre de lots et le nombre d'animaux par lots, et les justifier :\n","PrelevementEtFrequence"=>"\n\t- Indiquez le cas échéant le prélèvement, ainsi que la fréquence et le(s) volume(s) prélevés :\n","MethodeSuppressionDouleur"=>"\n- Indiquez le cas échéant les méthodes pour réduire ou supprimer la douleur, la souffrance et l'angoisse [liste des médications . anesthésiques, analgésiques, anti-inflammatoires, en précisant les doses, voies, durées et fréquences d'administration], y compris le raffinement des conditions d'hébergement, d'élevage et de soins :\n","MethodeSuppressionSouffrance"=>"- Indiquez le cas échéant les dispositions prises en vue de réduire, d'éviter et d'atténuer toute forme de souffrance des animaux de la naissance à la mort :\n","RaisonsScientifiquesDerogationAnestesie"=>"- Indiquez le cas échéant les raisons scientifiques justifiant une dérogation à l'anesthésie des animaux :\n","RaisonsScientifiquesDerogationHebergement"=>"- Indiquez le cas échéant les raisons scientifiques justifiant une dérogation aux conditions d'hébergement des animaux :\n","DispositionsPrisesEviterDoubleEmploi"=>"- Dispositions prises pour éviter tout double emploi injustifié des procédures expérimentales, le cas échéant :\n","DevenirAnimaux"=>"Devenir des animaux à la fin de cette procédure expérimentale :\n","MiseAMortAnimaux"=>"mise à mort ?","AnimauxMisAMort"=>"précisez les animaux concernés :\n","GardeEnVie"=>"animal gardé en vie ?","AnimauxGardesEnVie"=>"précisez les animaux concernés :\n","DecisionVeterinaire"=>"et si la décision a été prise par le vétérinaire ou toute autre personne compétente désignée par le responsable du projet :","MiseEnLiberte"=>"placement ou mise en liberté des animaux ?","AnimauxMisEnLiberte"=>"précisez les animaux concernés:\n","DevenirAnimaux"=>"\nQuel est le devenir des animaux","ExplicationsProcedures"=>"","UtilisationAnimauxProjetAnterieur"=>"\n4.3. Si le projet utilise des animaux réutilisés d'un projet antérieur :","GraviteReelle"=>"GRAVITÉ RÉELLE DES PROCÉDURES EXPÉRIMENTALES ANTÉRIEURES :\n","GraviteLegere"=>"légère","GraviteModeree"=>"modérée","GraviteSevere"=>"sévère","EffetCumulatif"=>"Effet cumulatif de cette réutilisation sur les animaux :","AvisVeterinaireFavorable"=>"L'avis vétérinaire est-il favorable en prenant en considération le sort de l'animal concerné sur toute sa durée de vie ?","EtatDeSanteRecouvre"=>"L'animal réutilisé a-t-il pleinement recouvré son état de santé et de bien-être général ?","ProjetContenantSouffranceSevere"=>"\n4.4. Cas particulier des projets contenant une procédure expérimentale impliquant une douleur,  une angoisse ou une souffrance sévère et susceptible de se prolonger sans qu'il soit possible de les soulager","ProcedureEnCause"=>"De quelle(s) procédure(s) expérimentale(s) du projet s'agit-il ?","JustificationScientifiqueProcedure"=>"Justifiez scientifiquement les raisons à l'origine d'une demande de dérogation :");

if ($line =~ /\w/ and $line !~ /</){
print OUT decode_entities($line),"\n";
}

foreach my $balise (keys %balises){

if($line=~ "<$balise>"){
$line =~ s/>true</>OUI</g;
$line =~ s/>false</>NON</g;
$line =~ s/<$balise>//;
$line =~ s/<\/$balise>//;
$line =~ s/   +/ /;
print OUT $balises{$balise},decode_entities($line),"\n";
}
else{
if($line=~ "<\/$balise>"){
$line =~ s/>true</>OUI</g;
$line =~ s/>false</>NON</g;
$line =~ s/<$balise>//;
$line =~ s/<\/$balise>//;
$line =~ s/   +/ /;

print OUT decode_entities($line),"\n";
}
}
}

}



close IN or die $!;
close OUT or die $!;
}

my $dir = cwd();
opendir DIR, $dir or die "cannot open dir $dir: $!";
my @tmpfiles = glob "$dir/*.doc";
closedir(DIR);

foreach(@tmpfiles){
open( I, "<:utf8", $_ ) or die "$ARGV[0]: $!";
my $utf = do { local $/; <I> };  # slurp it

# here's the magic part: replace each wide character with
# "\uN\5f", where "N" is the decimal numeric codepoint:

$utf =~ s/([^[:ascii:]])/sprintf("\\u%d\\'5f",ord($1))/eg;

my $out = $_;

my $rtf = RTF::Writer->new_to_file( $out );
my @pars = split( /\n+/, $utf );
$rtf->prolog( title => $out );
for my $par ( @pars ) {
    $rtf->paragraph( \$par );  # need to pass $par by reference
}
$rtf->close;
}

print "Conversion finie\nValidez pour fermer ce script.\n";
<STDIN>
}
else{exit;}

use Cwd;

my $dir = cwd();
opendir DIR, $dir or die "cannot open dir $dir: $!";
my @tmpfilestodelete = glob "$dir/*.tmp";
closedir(DIR);

foreach(@tmpfilestodelete){
  my $qfn = $_;

open IN,$qfn or die $!;
close IN,$qfn or die $!;
unlink IN,$qfn ;

}
